# NoStackCoroutine

一个高效的无栈协程（Stackless Coroutine）实现，专为嵌入式系统和资源受限环境设计。

## 🚀 主要特性

### 核心功能
- **无栈协程**：基于状态机的协程实现，无需为每个协程分配独立的栈空间
- **时间延时支持**：内置高精度定时器，支持毫秒级延时调度
- **信号量机制**：完整的信号量实现，支持协程间同步和互斥
- **SystemView集成**：深度集成SEGGER SystemView，提供实时系统分析和调试能力

### 技术优势
- **内存高效**：相比传统有栈协程，大幅减少内存占用
- **高性能调度**：O(1)时间复杂度的协程调度算法
- **实时响应**：支持硬实时系统要求
- **可视化调试**：通过SystemView实现协程状态可视化监控

## 🛠 系统架构

### 协程调度器
- 基于优先级的抢占式调度
- 支持时间片轮转调度
- 协程状态管理（就绪、运行、阻塞、延时等）

### 时间管理
- 高精度系统时钟
- 定时器管理
- 延时队列优化

### 同步原语
- 信号量（Semaphore）
- 互斥锁（Mutex）
- 事件标志组（Event Flags）

## 📊 SystemView 集成

本系统深度集成了SEGGER SystemView，提供以下调试和分析功能：

- **协程切换可视化**：实时显示协程切换时序图
- **系统资源监控**：CPU使用率、内存使用情况
- **性能分析**：协程执行时间统计、调度延迟分析
- **事件追踪**：信号量操作、定时器事件等系统事件记录

## 🔧 快速开始

### 基本使用示例

```c
 留待以后补充
```

### 信号量使用示例

```c
 以后补充
```

## 📋 系统要求

- **编译器**：支持C99标准的编译器
- **内存**：最小1KB RAM（取决于协程数量）
- **处理器**：任何32位或8位微控制器
- **RTOS**：可独立运行或集成到现有RTOS中

## ?? 编译和配置

### 编译选项
```makefile
# 启用SystemView支持
CFLAGS += -DENABLE_SYSTEMVIEW=1

# 配置最大协程数量
CFLAGS += -DMAX_COROUTINES=16

# 配置时钟频率
CFLAGS += -DSYSTEM_CLOCK_HZ=1000
```

### 移植指南
1. 实现平台相关的时钟获取函数
2. 配置SystemView的目标连接
3. 根据需要调整内存分配策略

## 📈 性能指标

- **协程切换时间**：< 10μs (Cortex-M4 @ 168MHz)
- **内存占用**：每协程 < 64字节
- **定时精度**：±1ms
- **最大协程数**：可配置，建议 < 32个

## 🤝 贡献指南

欢迎提交问题报告和功能请求！在提交代码前，请确保：

1. 代码符合项目编码规范
2. 添加适当的单元测试
3. 更新相关文档

## 📄 许可证

本项目采用 MIT 许可证 - 详见 [LICENSE](LICENSE) 文件。

## 🔗 相关资源

- [SEGGER SystemView官方文档](https://www.segger.com/products/development-tools/systemview/)
- [协程原理详解](docs/coroutine-theory.md)
- [API参考手册](docs/api-reference.md)
- [移植指南](docs/porting-guide.md)

---

**NoStackCoroutine** - 让协程编程更简单、更高效！